- include_tasks: php-tools.yml
  loop:
    - {package: "squizlabs/php_codesniffer", dir: "{{ php_tool_dir }}/phpcs", bin: ["phpcs"]}
    - {package: "friendsofphp/php-cs-fixer", dir: "{{ php_tool_dir }}/php-cs-fixer", bin: ["php-cs-fixer"]}
    - {package: "phploc/phploc", dir: "{{ php_tool_dir }}/phploc", bin: ["phploc"]}
    - {package: "phpmd/phpmd", dir: "{{ php_tool_dir }}/phpmd", bin: ["phpmd"]}
    - {package: "psy/psysh", dir: "{{ php_tool_dir }}/psysh", bin: ["psysh"]}
  loop_control:
    loop_var: tool

- include_tasks: python-tools.yml
  loop:
    - {py_version: 3.8, packages: ["httpie"], dir: "{{ python_tool_dir }}/httpie", bin: ["http"]}
    - {py_version: 3.8, packages: ["speedtest-cli"], dir: "{{ python_tool_dir }}/speedtest", bin: ["speedtest-cli"]}
    - {py_version: 3.8, packages: ["awscli", "awsebcli", "aws-shell"], dir: "{{ python_tool_dir }}/aws", bin: ["aws", "aws_completer", "aws_zsh_completer.sh", "aws-shell", "eb"]}
    - {py_version: 3.8, packages: ["docker-compose"], dir: "{{ python_tool_dir }}/docker-compose", bin: ["docker-compose"]}
    - {py_version: 3.8, packages: ["undervolt"], dir: "{{ python_tool_dir }}/undervolt", bin: ["undervolt"]}
  loop_control:
    loop_var: tool

- include_tasks: undervolt.yml
  args:
    apply:
      become: true

- name: Install saml2aws
  unarchive:
    src: https://github.com/Versent/saml2aws/releases/download/v2.25.0/saml2aws_2.25.0_linux_amd64.tar.gz
    dest: "{{ local_bin }}"
    creates: "{{ local_bin }}/saml2aws"
    remote_src: yes

- name: Install Etcher
  get_url:
    url: https://github.com/balena-io/etcher/releases/download/v1.5.81/balenaEtcher-1.5.81-x64.AppImage
    dest: "{{ local_bin }}/etcher"
    mode: "0755"
    checksum: sha512:9f97118edf58a3f60478b67ca6bb25b389663f6781b90800a076e500a3c8c4fee6d966ba846ae208a84218e164ffa24c53947431dabc261fe0518351b6ed471f

- name: Install drone cli
  unarchive:
    src: https://github.com/drone/drone-cli/releases/download/v1.2.1/drone_linux_amd64.tar.gz
    dest: "{{ local_bin }}"
    creates: "{{ local_bin }}/drone"
    remote_src: yes

- name: AWS Docker Credential Helper
  get_url:
    url: https://amazon-ecr-credential-helper-releases.s3.us-east-2.amazonaws.com/0.4.0/linux-amd64/docker-credential-ecr-login
    dest: "{{ local_bin }}/docker-credential-ecr-login"
    checksum: sha256:https://amazon-ecr-credential-helper-releases.s3.us-east-2.amazonaws.com/0.4.0/linux-amd64/docker-credential-ecr-login.sha256
    mode: "0755"
